<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>è²“å’ªè·³è·³å¤§å†’éšª</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background-color: #f0f0f0;
            font-family: Arial, sans-serif;
            touch-action: manipulation; /* é˜²æ­¢é›™æ“Šç¸®æ”¾ */
        }
        #gameCanvas {
            display: block;
            background: linear-gradient(#87CEEB, #E0F6FF); /* å¤©è—è‰²èƒŒæ™¯ */
        }
        #ui {
            position: absolute;
            top: 20px;
            left: 20px;
            font-size: 24px;
            font-weight: bold;
            color: #333;
        }
        #startMsg {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            font-size: 20px;
            background: rgba(255,255,255,0.8);
            padding: 20px;
            border-radius: 15px;
        }
    </style>
</head>
<body>

    <div id="ui">åˆ†æ•¸: 0</div>
    <div id="startMsg">é»æ“Šè¢å¹•æˆ–æŒ‰ç©ºç™½éµè·³èº<br>èº²é¿ä»™äººæŒï¼</div>
    <canvas id="gameCanvas"></canvas>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const scoreElement = document.getElementById('ui');
        const startMsg = document.getElementById('startMsg');

        // éŠæˆ²è¨­å®š
        let canvasWidth, canvasHeight;
        let gameActive = false;
        let score = 0;
        let gameSpeed = 5;

        // è§’è‰²è¨­å®š
        const cat = {
            x: 50,
            y: 0,
            width: 50,
            height: 50,
            velocityY: 0,
            gravity: 0.8,
            jumpStrength: -15,
            grounded: false
        };

        // éšœç¤™ç‰©
        let obstacles = [];
        let spawnTimer = 0;

        // åˆå§‹åŒ–ç•«å¸ƒå¤§å°
        function resize() {
            canvasWidth = window.innerWidth;
            canvasHeight = window.innerHeight;
            canvas.width = canvasWidth;
            canvas.height = canvasHeight;
            cat.y = canvasHeight - 100; // åˆå§‹ä½ç½®åœ¨åº•éƒ¨
        }

        window.addEventListener('resize', resize);
        resize();

        // è¼¸å…¥æ§åˆ¶
        function jump() {
            if (!gameActive) {
                resetGame();
                return;
            }
            if (cat.grounded) {
                cat.velocityY = cat.jumpStrength;
                cat.grounded = false;
            }
        }

        window.addEventListener('keydown', (e) => { if (e.code === 'Space') jump(); });
        window.addEventListener('touchstart', (e) => { 
            e.preventDefault(); // é˜²æ­¢æ‰‹æ©Ÿç«¯é»˜èªè¡Œç‚º
            jump(); 
        }, { passive: false });

        function resetGame() {
            score = 0;
            gameSpeed = 5;
            obstacles = [];
            cat.y = canvasHeight - 100;
            cat.velocityY = 0;
            gameActive = true;
            startMsg.style.display = 'none';
            scoreElement.innerText = `åˆ†æ•¸: ${score}`;
        }

        function createObstacle() {
            const size = 40 + Math.random() * 30;
            obstacles.push({
                x: canvasWidth,
                y: canvasHeight - 100,
                width: 30,
                height: size,
                color: '#2d5a27'
            });
        }

        function update() {
            if (!gameActive) return;

            // è²“å’ªç‰©ç†
            cat.velocityY += cat.gravity;
            cat.y += cat.velocityY;

            // è½åœ°æª¢æ¸¬
            if (cat.y > canvasHeight - 100) {
                cat.y = canvasHeight - 100;
                cat.velocityY = 0;
                cat.grounded = true;
            }

            // éšœç¤™ç‰©é‚è¼¯
            spawnTimer++;
            if (spawnTimer > Math.max(60, 120 - score)) { 
                createObstacle();
                spawnTimer = 0;
            }

            obstacles.forEach((obs, index) => {
                obs.x -= gameSpeed;

                // ç¢°æ’æª¢æ¸¬
                if (
                    cat.x < obs.x + obs.width &&
                    cat.x + cat.width > obs.x &&
                    cat.y < obs.y + obs.height &&
                    cat.y + cat.height > obs.y
                ) {
                    gameOver();
                }

                // ç§»é™¤å‡ºç•Œéšœç¤™ç‰©ä¸¦åŠ åˆ†
                if (obs.x + obs.width < 0) {
                    obstacles.splice(index, 1);
                    score++;
                    scoreElement.innerText = `åˆ†æ•¸: ${score}`;
                    if (score % 5 === 0) gameSpeed += 0.5; // éš¨åˆ†æ•¸å¢åŠ é€Ÿåº¦
                }
            });
        }

        function draw() {
            ctx.clearRect(0, 0, canvasWidth, canvasHeight);

            // ç•«åœ°æ¿
            ctx.fillStyle = '#8B4513';
            ctx.fillRect(0, canvasHeight - 50, canvasWidth, 50);

            // ç•«è²“å’ª (ä½¿ç”¨ Emoji)
            ctx.font = '50px Arial';
            ctx.fillText('ğŸ±', cat.x, cat.y + 45);

            // ç•«éšœç¤™ç‰©
            ctx.fillStyle = '#2d5a27';
            obstacles.forEach(obs => {
                ctx.fillText('ğŸŒµ', obs.x, obs.y + 40);
                // å¦‚æœæƒ³è¦çŸ©å½¢ç¢°æ’ç›’å¯è¦–åŒ–ï¼Œå¯ä»¥å–æ¶ˆä¸‹é¢è¨»é‡‹
                // ctx.fillRect(obs.x, obs.y, obs.width, obs.height);
            });

            requestAnimationFrame(() => {
                update();
                draw();
            });
        }

        function gameOver() {
            gameActive = false;
            startMsg.innerHTML = `éŠæˆ²çµæŸï¼<br>å¾—åˆ†: ${score}<br>é»æ“Šè¢å¹•é‡æ–°é–‹å§‹`;
            startMsg.style.display = 'block';
        }

        // é–‹å§‹å‹•ç•«å¾ªç’°
        draw();
    </script>
</body>
</html>
